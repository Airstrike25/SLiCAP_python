

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Building the MNA matrices &mdash; SLiCAP Programming 1.0.2020 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/myStyle.css" type="text/css" />
  

  
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="SLiCAP Programming 1.0.2020 documentation" href="index.html"/>
        <link rel="next" title="Python-Maxima interface" href="pythonMaximaInterface.html"/>
        <link rel="prev" title="SLiCAP math library" href="math.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="slicap-programming.html" class="icon icon-home"> SLiCAP Programming
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">SLiCAP open-source</a></li>
<li class="toctree-l1"><a class="reference internal" href="ToDo.html">ToDo</a></li>
<li class="toctree-l1"><a class="reference internal" href="configure.html">SLiCAP configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="math.html">SLiCAP math library</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Building the MNA matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythonMaximaInterface.html">Python-Maxima interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="html.html">HTML reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="Parser.html">SLiCAP netlist parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="parsingMethod.html">Parsing method</a></li>
<li class="toctree-l1"><a class="reference internal" href="modelParams.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="subCircuits.html">Sub circuits</a></li>
<li class="toctree-l1"><a class="reference internal" href="library.html">SLiCAP Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="execute.html">Execute</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot.html">Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="SLiCAPreference.html">SLiCAP Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="slicap-programming.html">SLiCAP Programming</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="slicap-programming.html">Docs</a> &raquo;</li>
        
      <li>Building the MNA matrices</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/matrices.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="building-the-mna-matrices">
<h1>Building the MNA matrices<a class="headerlink" href="#building-the-mna-matrices" title="Permalink to this headline">Â¶</a></h1>
<p>The MNA matrices are built with matrix stamps of basic elements. The position of the stamp in the matrix follows from the postion of the dependent variables (nodal voltages and branch currents) of these elements. They are stored in the .depVars attribute of the circuit object.</p>
<p>Matrices can be built with symbolic or numeric.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">SLiCAP module for building the MNA matrix and the associated vectors.</span>

<span class="sd">Imported by the module **SLiCAPpythonMaxima.py**</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">SLiCAPprotos</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">getValues</span><span class="p">(</span><span class="n">elmt</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">numeric</span><span class="p">,</span> <span class="n">parDefs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the symbolic or numeric value of numerator and the denominator</span>
<span class="sd">    of a parameter of an element. This function is called by makeMatrices().</span>
<span class="sd">        </span>
<span class="sd">    :parm elmt: element object</span>
<span class="sd">    :type elmt: SLiCAPprotos.element</span>
<span class="sd">    </span>
<span class="sd">    :param param: parameter of interest (&#39;value&#39;, &#39;noise&#39;, &#39;dc&#39; or &#39;dcvar&#39;)</span>
<span class="sd">    :type param: str</span>
<span class="sd">    </span>
<span class="sd">    :param numeric: If True is uses full substitution and sp.N for converting</span>
<span class="sd">                    parameters to sympy floats</span>
<span class="sd">    :type numeric: bool</span>
<span class="sd">    </span>
<span class="sd">    :param parDefs: Dict with key value pairs:</span>
<span class="sd">                    </span>
<span class="sd">                    - key  : parameter name (sympy.Symbol)</span>
<span class="sd">                    - value: numeric value of sympy expression</span>
<span class="sd">    :type parDefs: dict                </span>
<span class="sd">    </span>
<span class="sd">    :return: Tuple with sympy expresssions or numeric values of the numerator </span>
<span class="sd">             and the denominator of the element parameter.</span>
<span class="sd">    :return type: tuple</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">numeric</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">fullSubs</span><span class="p">(</span><span class="n">elmt</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">param</span><span class="p">],</span> <span class="n">parDefs</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">elmt</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">param</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ini</span><span class="o">.</span><span class="n">Laplace</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">):</span>
            <span class="p">(</span><span class="n">numer</span><span class="p">,</span> <span class="n">denom</span><span class="p">)</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">fraction</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">numer</span> <span class="o">=</span> <span class="n">value</span>
            <span class="n">denom</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">numer</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">denom</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">numer</span><span class="p">,</span> <span class="n">denom</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">getValue</span><span class="p">(</span><span class="n">elmt</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">numeric</span><span class="p">,</span> <span class="n">parDefs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the symbolic or numeric value of a parameter of an element.</span>
<span class="sd">    </span>
<span class="sd">    This function is called by makeMatrices().</span>
<span class="sd">        </span>
<span class="sd">    :parm elmt: element object</span>
<span class="sd">    :type elmt: SLiCAPprotos.element</span>
<span class="sd">    </span>
<span class="sd">    :param param: parameter of interest (&#39;value&#39;, &#39;noise&#39;, &#39;dc&#39; or &#39;dcvar&#39;)</span>
<span class="sd">    :type param: str</span>
<span class="sd">    </span>
<span class="sd">    :param numeric: If True is uses full substitution and sympy.N for converting</span>
<span class="sd">                    parameters to sympy floats</span>
<span class="sd">    :type numeric: bool</span>
<span class="sd">    </span>
<span class="sd">    :param parDefs: Dict with key value pairs:</span>
<span class="sd">                    </span>
<span class="sd">                    - key  : parameter name (sympy.Symbol)</span>
<span class="sd">                    - value: numeric value of sympy expression</span>
<span class="sd">    :type parDefs: dict</span>
<span class="sd">    </span>
<span class="sd">    :return: value: sympy expresssion or numeric value of the element parameter</span>
<span class="sd">    :return type: sympy.Expr, int, float, sympy.Float</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">elmt</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">numeric</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>        
        <span class="n">value</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">fullSubs</span><span class="p">(</span><span class="n">elmt</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">param</span><span class="p">],</span> <span class="n">parDefs</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">elmt</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">param</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">value</span>
        
<span class="k">def</span> <span class="nf">makeMatrices</span><span class="p">(</span><span class="n">cir</span><span class="p">,</span> <span class="n">parDefs</span><span class="p">,</span> <span class="n">numeric</span><span class="p">,</span> <span class="n">gainType</span><span class="p">,</span> <span class="n">lgRef</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the MNA matrix and the vector with dependent variables of a circuit.</span>
<span class="sd">    </span>
<span class="sd">    Modifications in the circuit object, necessary for calculation of different</span>
<span class="sd">    gain types are temporary. The circuit data before and after</span>
<span class="sd">    running &#39;makeMatrices&#39; is the same:</span>
<span class="sd">    </span>
<span class="sd">    #. If gainType == &#39;asymptotic&#39;:</span>
<span class="sd">    </span>
<span class="sd">       - store the model of lgRef</span>
<span class="sd">       - modify the model of lgRef to &#39;N&#39;</span>
<span class="sd">       - update depVars and varIndex</span>
<span class="sd">       - create the matrices</span>
<span class="sd">       - restore the model of lgRef</span>
<span class="sd">       - update depVars and varIndex</span>
<span class="sd">        </span>
<span class="sd">    #. If gainType == &#39;direct&#39;, &#39;loopgain&#39; or &#39;servo&#39;:</span>
<span class="sd">    </span>
<span class="sd">       - store value of lgRef</span>
<span class="sd">       - set value of lgRef element to zero</span>
<span class="sd">       - create the matrices</span>
<span class="sd">       - restore the value of lgRef</span>
<span class="sd">        </span>
<span class="sd">       - loopgain and servo will be calculated with the output of lgRef </span>
<span class="sd">         as source and the input of lgRef as detector.</span>
<span class="sd">        </span>
<span class="sd">    #. If gainType == &#39;vi&#39; or &#39;gain&#39;:</span>
<span class="sd">    </span>
<span class="sd">       - no alterations of the circuit need to be made</span>
<span class="sd">        </span>
<span class="sd">    :param cir: Circuit of which the matrices need to be returned.</span>
<span class="sd">    :type cir: SLiCAPprotos.circuit</span>

<span class="sd">    :param parDefs: Dict with key value pairs:</span>
<span class="sd">                    </span>
<span class="sd">                    - key  : parameter name (sympy.Symbol)</span>
<span class="sd">                    - value: numeric value of sympy expression</span>
<span class="sd">    :type parDefs: dict</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    :param numeric: If True is uses full substitution and sympy.N for converting</span>
<span class="sd">                    parameters to sympy floats</span>
<span class="sd">    :type numeric: bool</span>
<span class="sd">    </span>
<span class="sd">    :param gainType: Gain type of the instruction</span>
<span class="sd">    :type gainType: str</span>
<span class="sd">    </span>
<span class="sd">    :param lgRef: ID of the loop gain reference of the instruction</span>
<span class="sd">    :type lgRef: str   </span>
<span class="sd">    </span>
<span class="sd">    :return: tuple with two sympy matrices:</span>
<span class="sd">        </span>
<span class="sd">             #. MNA matrix M</span>
<span class="sd">             #. Vector with dependent variables Dv</span>
<span class="sd">    :return type: tuple</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">gainType</span> <span class="o">==</span> <span class="s1">&#39;vi&#39;</span> <span class="ow">or</span> <span class="n">gainType</span> <span class="o">==</span> <span class="s1">&#39;gain&#39;</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">gainType</span> <span class="o">==</span> <span class="s1">&#39;direct&#39;</span> <span class="ow">or</span> <span class="n">gainType</span> <span class="o">==</span> <span class="s1">&#39;loopgain&#39;</span> <span class="ow">or</span> <span class="n">gainType</span> <span class="o">==</span> <span class="s1">&#39;servo&#39;</span><span class="p">:</span>
        <span class="n">lgValue</span> <span class="o">=</span> <span class="n">cir</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">lgRef</span><span class="p">]</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="n">cir</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">lgRef</span><span class="p">]</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">gainType</span> <span class="o">==</span> <span class="s1">&#39;asymptotic&#39;</span><span class="p">:</span>
        <span class="n">lgRefModel</span> <span class="o">=</span> <span class="n">cir</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">lgRef</span><span class="p">]</span><span class="o">.</span><span class="n">model</span>
        <span class="n">cir</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">lgRef</span><span class="p">]</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="s1">&#39;N&#39;</span>
        <span class="n">cir</span><span class="o">.</span><span class="n">updateMdata</span><span class="p">()</span>
    <span class="n">varIndex</span> <span class="o">=</span> <span class="n">cir</span><span class="o">.</span><span class="n">varIndex</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cir</span><span class="o">.</span><span class="n">varIndex</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">Dv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">)]</span>
    <span class="n">M</span>  <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cir</span><span class="o">.</span><span class="n">depVars</span><span class="p">)):</span>
        <span class="n">Dv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="n">cir</span><span class="o">.</span><span class="n">depVars</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">cir</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">elmt</span> <span class="o">=</span> <span class="n">cir</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">el</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">elmt</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span>
            <span class="n">pos0</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">pos1</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">getValue</span><span class="p">(</span><span class="n">elmt</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">numeric</span><span class="p">,</span> <span class="n">parDefs</span><span class="p">)</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos0</span><span class="p">][</span><span class="n">pos0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">ini</span><span class="o">.</span><span class="n">Laplace</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos0</span><span class="p">][</span><span class="n">pos1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">ini</span><span class="o">.</span><span class="n">Laplace</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos1</span><span class="p">][</span><span class="n">pos0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">ini</span><span class="o">.</span><span class="n">Laplace</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos1</span><span class="p">][</span><span class="n">pos1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">ini</span><span class="o">.</span><span class="n">Laplace</span>
        <span class="k">elif</span> <span class="n">elmt</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span>
            <span class="n">dVarPos</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="s1">&#39;I_&#39;</span><span class="o">+</span> <span class="n">elmt</span><span class="o">.</span><span class="n">refDes</span><span class="p">]</span>
            <span class="n">pos0</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">pos1</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">getValue</span><span class="p">(</span><span class="n">elmt</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">numeric</span><span class="p">,</span> <span class="n">parDefs</span><span class="p">)</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos0</span><span class="p">][</span><span class="n">dVarPos</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos1</span><span class="p">][</span><span class="n">dVarPos</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPos</span><span class="p">][</span><span class="n">pos0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPos</span><span class="p">][</span><span class="n">pos1</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPos</span><span class="p">][</span><span class="n">dVarPos</span><span class="p">]</span> <span class="o">-=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">ini</span><span class="o">.</span><span class="n">Laplace</span>
        <span class="k">elif</span> <span class="n">elmt</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;R&#39;</span><span class="p">:</span>
            <span class="n">pos0</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">pos1</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">value</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">getValue</span><span class="p">(</span><span class="n">elmt</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">numeric</span><span class="p">,</span> <span class="n">parDefs</span><span class="p">)</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos0</span><span class="p">][</span><span class="n">pos0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">value</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos0</span><span class="p">][</span><span class="n">pos1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">value</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos1</span><span class="p">][</span><span class="n">pos0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">value</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos1</span><span class="p">][</span><span class="n">pos1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="n">elmt</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span>
            <span class="n">dVarPos</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="s1">&#39;I_&#39;</span> <span class="o">+</span> <span class="n">elmt</span><span class="o">.</span><span class="n">refDes</span><span class="p">]</span>
            <span class="n">pos0</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">pos1</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">getValue</span><span class="p">(</span><span class="n">elmt</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">numeric</span><span class="p">,</span> <span class="n">parDefs</span><span class="p">)</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos0</span><span class="p">][</span><span class="n">dVarPos</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos1</span><span class="p">][</span><span class="n">dVarPos</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPos</span><span class="p">][</span><span class="n">pos0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPos</span><span class="p">][</span><span class="n">pos1</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPos</span><span class="p">][</span><span class="n">dVarPos</span><span class="p">]</span> <span class="o">-=</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="n">elmt</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;E&#39;</span><span class="p">:</span>
            <span class="n">dVarPos</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="s1">&#39;I_o_&#39;</span> <span class="o">+</span> <span class="n">elmt</span><span class="o">.</span><span class="n">refDes</span><span class="p">]</span>
            <span class="n">pos0</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">pos1</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">pos2</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
            <span class="n">pos3</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
            <span class="p">(</span><span class="n">numer</span><span class="p">,</span> <span class="n">denom</span><span class="p">)</span> <span class="o">=</span> <span class="n">getValues</span><span class="p">(</span><span class="n">elmt</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">numeric</span><span class="p">,</span> <span class="n">parDefs</span><span class="p">)</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos0</span><span class="p">][</span><span class="n">dVarPos</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos1</span><span class="p">][</span><span class="n">dVarPos</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPos</span><span class="p">][</span><span class="n">pos0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">denom</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPos</span><span class="p">][</span><span class="n">pos1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">denom</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPos</span><span class="p">][</span><span class="n">pos2</span><span class="p">]</span> <span class="o">-=</span> <span class="n">numer</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPos</span><span class="p">][</span><span class="n">pos3</span><span class="p">]</span> <span class="o">+=</span> <span class="n">numer</span>
        <span class="k">elif</span> <span class="n">elmt</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;EZ&#39;</span><span class="p">:</span>
            <span class="n">dVarPos</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="s1">&#39;I_o_&#39;</span> <span class="o">+</span> <span class="n">elmt</span><span class="o">.</span><span class="n">refDes</span><span class="p">]</span>
            <span class="n">pos0</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">pos1</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">pos2</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
            <span class="n">pos3</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
            <span class="p">(</span><span class="n">numer</span><span class="p">,</span> <span class="n">denom</span><span class="p">)</span> <span class="o">=</span> <span class="n">getValues</span><span class="p">(</span><span class="n">elmt</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">numeric</span><span class="p">,</span> <span class="n">parDefs</span><span class="p">)</span>
            <span class="p">(</span><span class="n">zoN</span><span class="p">,</span> <span class="n">zoD</span><span class="p">)</span> <span class="o">=</span> <span class="n">getValues</span><span class="p">(</span><span class="n">elmt</span><span class="p">,</span> <span class="s1">&#39;zo&#39;</span><span class="p">,</span> <span class="n">numeric</span><span class="p">,</span> <span class="n">parDefs</span><span class="p">)</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos0</span><span class="p">][</span><span class="n">dVarPos</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos1</span><span class="p">][</span><span class="n">dVarPos</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPos</span><span class="p">][</span><span class="n">pos0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">denom</span> <span class="o">*</span> <span class="n">zoD</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPos</span><span class="p">][</span><span class="n">pos1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">denom</span> <span class="o">*</span> <span class="n">zoD</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPos</span><span class="p">][</span><span class="n">pos2</span><span class="p">]</span> <span class="o">-=</span> <span class="n">numer</span> <span class="o">*</span> <span class="n">zoD</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPos</span><span class="p">][</span><span class="n">pos3</span><span class="p">]</span> <span class="o">+=</span> <span class="n">numer</span> <span class="o">*</span> <span class="n">zoD</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPos</span><span class="p">][</span><span class="n">dVarPos</span><span class="p">]</span> <span class="o">-=</span> <span class="n">zoN</span> <span class="o">*</span> <span class="n">denom</span>
        <span class="k">elif</span> <span class="n">elmt</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span>
            <span class="n">dVarPos</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="s1">&#39;I_i_&#39;</span> <span class="o">+</span> <span class="n">elmt</span><span class="o">.</span><span class="n">refDes</span><span class="p">]</span>
            <span class="n">pos0</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">pos1</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">pos2</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
            <span class="n">pos3</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
            <span class="p">(</span><span class="n">numer</span><span class="p">,</span> <span class="n">denom</span><span class="p">)</span> <span class="o">=</span> <span class="n">getValues</span><span class="p">(</span><span class="n">elmt</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">numeric</span><span class="p">,</span> <span class="n">parDefs</span><span class="p">)</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos0</span><span class="p">][</span><span class="n">dVarPos</span><span class="p">]</span> <span class="o">+=</span> <span class="n">numer</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos1</span><span class="p">][</span><span class="n">dVarPos</span><span class="p">]</span> <span class="o">-=</span> <span class="n">numer</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos2</span><span class="p">][</span><span class="n">dVarPos</span><span class="p">]</span> <span class="o">+=</span> <span class="n">denom</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos3</span><span class="p">][</span><span class="n">dVarPos</span><span class="p">]</span> <span class="o">-=</span> <span class="n">denom</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPos</span><span class="p">][</span><span class="n">pos2</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPos</span><span class="p">][</span><span class="n">pos3</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">elmt</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span>
            <span class="n">pos0</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">pos1</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">pos2</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
            <span class="n">pos3</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">getValue</span><span class="p">(</span><span class="n">elmt</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">numeric</span><span class="p">,</span> <span class="n">parDefs</span><span class="p">)</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos0</span><span class="p">][</span><span class="n">pos2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">value</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos0</span><span class="p">][</span><span class="n">pos3</span><span class="p">]</span> <span class="o">-=</span> <span class="n">value</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos1</span><span class="p">][</span><span class="n">pos2</span><span class="p">]</span> <span class="o">-=</span> <span class="n">value</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos1</span><span class="p">][</span><span class="n">pos3</span><span class="p">]</span> <span class="o">+=</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="n">elmt</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;G&#39;</span><span class="p">:</span>
            <span class="n">dVarPos</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="s1">&#39;I_o_&#39;</span> <span class="o">+</span> <span class="n">elmt</span><span class="o">.</span><span class="n">refDes</span><span class="p">]</span>
            <span class="n">pos0</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">pos1</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">pos2</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
            <span class="n">pos3</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
            <span class="p">(</span><span class="n">numer</span><span class="p">,</span> <span class="n">denom</span><span class="p">)</span> <span class="o">=</span> <span class="n">getValues</span><span class="p">(</span><span class="n">elmt</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">numeric</span><span class="p">,</span> <span class="n">parDefs</span><span class="p">)</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos0</span><span class="p">][</span><span class="n">dVarPos</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos1</span><span class="p">][</span><span class="n">dVarPos</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPos</span><span class="p">][</span><span class="n">pos2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">numer</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPos</span><span class="p">][</span><span class="n">pos3</span><span class="p">]</span> <span class="o">-=</span> <span class="n">numer</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPos</span><span class="p">][</span><span class="n">dVarPos</span><span class="p">]</span> <span class="o">-=</span> <span class="n">denom</span>
        <span class="k">elif</span> <span class="n">elmt</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span>
            <span class="n">dVarPosO</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="s1">&#39;I_o_&#39;</span> <span class="o">+</span> <span class="n">elmt</span><span class="o">.</span><span class="n">refDes</span><span class="p">]</span>
            <span class="n">dVarPosI</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="s1">&#39;I_i_&#39;</span> <span class="o">+</span> <span class="n">elmt</span><span class="o">.</span><span class="n">refDes</span><span class="p">]</span>
            <span class="n">pos0</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">pos1</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">pos2</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
            <span class="n">pos3</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
            <span class="p">(</span><span class="n">numer</span><span class="p">,</span> <span class="n">denom</span><span class="p">)</span> <span class="o">=</span> <span class="n">getValues</span><span class="p">(</span><span class="n">elmt</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">numeric</span><span class="p">,</span> <span class="n">parDefs</span><span class="p">)</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos0</span><span class="p">][</span><span class="n">dVarPosO</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos1</span><span class="p">][</span><span class="n">dVarPosO</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos2</span><span class="p">][</span><span class="n">dVarPosI</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos3</span><span class="p">][</span><span class="n">dVarPosI</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPosI</span><span class="p">][</span><span class="n">pos2</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPosI</span><span class="p">][</span><span class="n">pos3</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPosO</span><span class="p">][</span><span class="n">pos0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">denom</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPosO</span><span class="p">][</span><span class="n">pos1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">denom</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPosO</span><span class="p">][</span><span class="n">dVarPosI</span><span class="p">]</span> <span class="o">-=</span> <span class="n">numer</span>
        <span class="k">elif</span> <span class="n">elmt</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;HZ&#39;</span><span class="p">:</span>
            <span class="n">dVarPosO</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="s1">&#39;I_o_&#39;</span> <span class="o">+</span> <span class="n">elmt</span><span class="o">.</span><span class="n">refDes</span><span class="p">]</span>
            <span class="n">dVarPosI</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="s1">&#39;I_i_&#39;</span> <span class="o">+</span> <span class="n">elmt</span><span class="o">.</span><span class="n">refDes</span><span class="p">]</span>
            <span class="n">pos0</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">pos1</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">pos2</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
            <span class="n">pos3</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
            <span class="p">(</span><span class="n">numer</span><span class="p">,</span> <span class="n">denom</span><span class="p">)</span> <span class="o">=</span> <span class="n">getValues</span><span class="p">(</span><span class="n">elmt</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">numeric</span><span class="p">,</span> <span class="n">parDefs</span><span class="p">)</span>
            <span class="p">(</span><span class="n">zoN</span><span class="p">,</span> <span class="n">zoD</span><span class="p">)</span> <span class="o">=</span> <span class="n">getValues</span><span class="p">(</span><span class="n">elmt</span><span class="p">,</span> <span class="s1">&#39;zo&#39;</span><span class="p">,</span> <span class="n">numeric</span><span class="p">,</span> <span class="n">parDefs</span><span class="p">)</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos0</span><span class="p">][</span><span class="n">dVarPosO</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos1</span><span class="p">][</span><span class="n">dVarPosO</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos2</span><span class="p">][</span><span class="n">dVarPosI</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos3</span><span class="p">][</span><span class="n">dVarPosI</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPosI</span><span class="p">][</span><span class="n">pos2</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPosI</span><span class="p">][</span><span class="n">pos3</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPosO</span><span class="p">][</span><span class="n">pos0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">denom</span> <span class="o">*</span> <span class="n">zoD</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPosO</span><span class="p">][</span><span class="n">pos1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">denom</span> <span class="o">*</span> <span class="n">zoD</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPosO</span><span class="p">][</span><span class="n">dVarPosI</span><span class="p">]</span> <span class="o">-=</span> <span class="n">numer</span> <span class="o">*</span> <span class="n">zoD</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPosO</span><span class="p">][</span><span class="n">dVarPosO</span><span class="p">]</span> <span class="o">-=</span> <span class="n">zoN</span> <span class="o">*</span> <span class="n">denom</span>
        <span class="k">elif</span> <span class="n">elmt</span><span class="o">.</span><span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span>
            <span class="n">dVarPos</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="s1">&#39;I_o_&#39;</span> <span class="o">+</span> <span class="n">elmt</span><span class="o">.</span><span class="n">refDes</span><span class="p">]</span>
            <span class="n">pos0</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">pos1</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">pos2</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
            <span class="n">pos3</span> <span class="o">=</span> <span class="n">varIndex</span><span class="p">[</span><span class="n">elmt</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos0</span><span class="p">][</span><span class="n">dVarPos</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">pos1</span><span class="p">][</span><span class="n">dVarPos</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">M</span><span class="p">[</span><span class="n">dVarPos</span><span class="p">][</span><span class="n">pos2</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</td></tr></table></div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pythonMaximaInterface.html" class="btn btn-neutral float-right" title="Python-Maxima interface" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="math.html" class="btn btn-neutral" title="SLiCAP math library" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, SLiCAP development team.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.2020',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>